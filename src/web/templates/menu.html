<aside
  id="sidebar"
  class="flex flex-col flex-shrink-0 bg-gray-800 transition-all duration-300 ease-in-out z-20"
  style="width: 250px"
>
  <!-- Sidebar Header -->
  <div
    class="flex items-center justify-between h-16 px-4 border-b border-gray-700 flex-shrink-0"
  >
    <span
      id="logo-text"
      class="text-xl font-extrabold text-blue-400 tracking-tight transition-opacity duration-300"
    >
      ThermoTrack
    </span>
    <button
      id="toggle-sidebar-btn"
      class="btn p-2 hover:bg-gray-700 text-gray-400"
    >
      <svg
        id="collapse-icon"
        class="w-6 h-6 transform rotate-0 transition-transform duration-300"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M11 19l-7-7 7-7m8 14l-7-7 7-7"
        ></path>
      </svg>
    </button>
  </div>

  <!-- Navigation Links -->
  <nav class="flex-1 p-4 space-y-2">
    {% set nav_items = [ {'endpoint': 'dashboard', 'text': 'Dashboard', 'icon':
    'M3 10h18M3 14h18m-9-4v8m-9-6h2m13 0h2m-2-2h2m-13-2h2'}, {'endpoint':
    'setup', 'text': 'Setup', 'icon': 'M10.325 4.317c.426-1.756 2.924-1.756 3.35
    0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0
    001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94
    1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924
    1.756-3.35 0a1.724 1.724 0
    00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0
    00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0
    001.066-2.573c-.94-1.543.826-3.31 2.37-2.37a1.724 1.724 0 002.572-1.065z M15
    12a3 3 0 11-6 0 3 3 0 016 0z'}, {'endpoint': 'reports', 'text': 'Reports',
    'icon': 'M9 17v-2m3 2v-4m3 4v-6m2 2h2m-13 0h2M6 10h.01M10 10h.01M14
    10h.01M18 10h.01M5 16h2m10 0h2M12 4h.01M12 20h.01M4 14h2m14 0h2M4 18h2m14
    0h2m-4-8h-6m2 0H8M12 4v2m0 12v2'}, {'endpoint': 'policies', 'text':
    'Policies', 'icon': 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1
    1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z'} ] %} {% for
    item in nav_items %} {# Hide Setup menu for non-admins #} {% if
    item.endpoint == 'setup' and session.get('role') != 'admin' %} {# Skip this
    menu item #} {% else %}
    <a
      href="{{ url_for(item.endpoint) }}"
      class="flex items-center p-3 rounded-lg font-semibold transition duration-200 whitespace-nowrap {% if active_page == item.endpoint %} bg-blue-700 text-white shadow-md {% else %} text-gray-300 hover:bg-gray-700 {% endif %}"
    >
      <svg
        class="w-5 h-5 mr-3 flex-shrink-0"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="{{ item.icon }}"
        ></path>
      </svg>
      <span class="link-text">{{ item.text }}</span>
    </a>
    {% endif %} {% endfor %} {% if session.get('username') %}
    <a
      href="{{ url_for('settings') }}"
      class="flex items-center p-3 rounded-lg font-semibold transition duration-200 whitespace-nowrap {% if active_page == 'settings' %}bg-blue-700 text-white shadow-md{% else %}text-gray-300 hover:bg-gray-700{% endif %}"
    >
      <svg
        class="w-5 h-5 mr-3 flex-shrink-0"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37a1.724 1.724 0 002.572-1.065z"
        ></path>
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
        ></path>
      </svg>
      <span class="link-text">Settings</span>
    </a>
    {% endif %}
  </nav>

  <!-- Theme Toggle -->
  <div class="px-4 py-2 border-t border-gray-700 flex justify-center">
    <button
      id="sidebar-theme-toggle"
      class="flex items-center justify-center w-10 h-10 rounded-lg font-semibold text-gray-300 hover:bg-gray-700 transition duration-200"
      title="Toggle theme"
    >
      <svg
        id="sidebar-sun-icon"
        class="w-5 h-5 hidden"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
        ></path>
      </svg>
      <svg
        id="sidebar-moon-icon"
        class="w-5 h-5"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
        ></path>
      </svg>
    </button>
  </div>

  <!-- Bottom section -->
  <div class="px-4 py-3 border-t border-gray-700 flex-shrink-0">
    {% if session.get('username') %}
    <div class="mb-3">
      <p
        id="user-greeting"
        class="text-xs text-gray-400 font-medium whitespace-nowrap transition-opacity duration-300"
      >
        Greeting:
        <span class="text-sm font-bold text-white"
          >{{ session.get('username') }}</span
        >
      </p>
    </div>

    <a
      href="{{ url_for('logout') }}"
      class="flex items-center p-3 rounded-lg font-semibold text-red-400 bg-gray-700 hover:bg-red-900/50 transition duration-200 whitespace-nowrap"
    >
      <svg
        class="w-5 h-5 mr-3 flex-shrink-0"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
        ></path>
      </svg>
      <span class="link-text">Logout</span>
    </a>

    {% else %}
    <div id="auth-links" class="space-y-2">
      <a
        href="{{ url_for('login') }}"
        class="block px-3 py-2 rounded-md font-medium text-blue-400 hover:bg-gray-700"
        >Login</a
      >
      <a
        href="{{ url_for('register') }}"
        class="block px-3 py-2 rounded-md font-medium bg-blue-600 text-white hover:bg-blue-700"
        >Register</a
      >
    </div>
    {% endif %}
  </div>
</aside>

<script src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
